(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0a3147"],{"013c":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{attrs:{bordered:!1}},[a("div",{staticClass:"table-page-search-wrapper"},[a("a-form",{attrs:{layout:"inline"}},[a("a-row",{attrs:{gutter:48}},[a("a-col",{attrs:{md:4,sm:24}},[a("a-input",{attrs:{allowClear:"",placeholder:"请输入表名"},model:{value:e.queryParam.tablename,callback:function(t){e.$set(e.queryParam,"tablename",t)},expression:"queryParam.tablename"}})],1),a("a-col",{attrs:{md:4,sm:24}},[a("a-select",{attrs:{allowClear:"",placeholder:"请选择引擎","default-value":"0"},model:{value:e.queryParam.engine,callback:function(t){e.$set(e.queryParam,"engine",t)},expression:"queryParam.engine"}},[a("a-select-option",{attrs:{value:"MyISAM"}},[e._v("MyISAM")]),a("a-select-option",{attrs:{value:"InnoDB"}},[e._v("InnoDB")])],1)],1),a("a-col",{attrs:{md:4,sm:24}},[a("span",{staticClass:"table-page-search-submitButtons"},[a("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.$refs.table.refresh(!0)}}},[e._v("查询")]),a("a-button",{staticStyle:{"margin-left":"8px"},on:{click:function(t){return e.resetSearchForm()}}},[e._v("重置")])],1)])],1)],1)],1),e.selectTables.length>0?a("div",{staticClass:"table-operator"},[a("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:function(t){return e.optimizeTables()}}},[e._v("优化")]),a("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:e.backupTables}},[e._v("备份")])],1):e._e(),a("s-table",{ref:"table",attrs:{size:"default",rowKey:"name",bordered:!0,columns:e.columns,data:e.loadData,alert:e.options.alert,rowSelection:e.options.rowSelection,showPagination:"auto"},scopedSlots:e._u([{key:"action",fn:function(t,n){return a("span",{},[[a("a",{on:{click:function(t){return e.$refs.tableModal.add(n.name)}}},[e._v("查看")])]],2)}}])}),a("table-view",{ref:"tableModal",on:{ok:e.handleOk}})],1)},l=[],s=a("2af9"),o=a("b775");function r(e){return Object(o["b"])({url:"/tables",method:"get",params:e})}function i(e){return Object(o["b"])({url:"/table/optimize",method:"post",data:e})}function c(e){return Object(o["b"])({url:"/table/backup",method:"post",data:e})}function u(e){return Object(o["b"])({url:"/table/view/"+e,method:"get"})}var d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{bordered:"",title:"表结构",width:1200,rowKey:"field",visible:e.visible},on:{cancel:e.handleCancel}},[a("a-table",{attrs:{columns:e.columns,dataSource:e.fields,pagination:!1}})],1)},b=[],m={data:function(){return{columns:[{title:"字段名称",dataIndex:"field"},{title:"类型",dataIndex:"type"},{title:"字符集",dataIndex:"collation"},{title:"Null",dataIndex:"null"},{title:"索引",dataIndex:"key"},{title:"默认值",dataIndex:"default"},{title:"权限",dataIndex:"privileges"},{title:"注释",dataIndex:"comment"}],labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:13}},visible:!1,fields:[]}},methods:{add:function(e){var t=this;this.visible=!0,u(e).then((function(e){t.fields=e.data}))},handleCancel:function(){this.visible=!1}}},p=m,f=a("2877"),h=Object(f["a"])(p,d,b,!1,null,null,null),v=h.exports,w={name:"Database",components:{STable:s["f"],TableView:v},data:function(){var e=this;return{queryParam:{},columns:[{title:"表名",dataIndex:"name"},{title:"表引擎",dataIndex:"engine"},{title:"字符集",dataIndex:"collation"},{title:"数据行数",dataIndex:"rows",sorter:!0},{title:"索引大小",dataIndex:"index_length",sorter:!0},{title:"数据大小",dataIndex:"data_length",sorter:!0},{title:"表注释",dataIndex:"comment",sorter:!0},{title:"创建时间",dataIndex:"create_time",sorter:!0},{title:"操作",dataIndex:"action",width:"70px",scopedSlots:{customRender:"action"}}],loadData:function(t){return r(Object.assign(t,e.queryParam)).then((function(e){return e}))},selectTables:[],options:{alert:{show:!1,clear:function(){e.selectedRowKeys=[]}},rowSelection:{selectedRowKeys:this.selectedRowKeys,onChange:this.onSelectChange}}}},methods:{optimizeTables:function(){var e=this;i({data:this.selectTables}).then((function(t){e.$notification["success"]({message:t.message,duration:4}),e.selectTables=[]}))},backupTables:function(){var e=this;c({data:this.selectTables}).then((function(t){e.$notification["success"]({message:t.message,duration:4}),e.selectTables=[]}))},handleOk:function(){this.$refs.table.refresh(!0)},onSelectChange:function(e,t){this.selectTables=e},resetSearchForm:function(){this.queryParam={},this.handleOk()}}},y=w,x=Object(f["a"])(y,n,l,!1,null,null,null);t["default"]=x.exports}}]);